{"version":3,"file":"details.min.js","sources":["../src/details.js"],"sourcesContent":["\nimport Fragment, {loadFragment} from 'core/fragment';\nimport Templates from 'core/templates';\nimport Pending from 'core/pending';\nimport {prefetchStrings} from 'core/prefetch';\nimport {get_string as getString} from 'core/str';\nimport DynamicForm from 'core_form/dynamicform';\nimport {add as addToast} from 'core/toast';\nimport {markFormAsDirty} from 'core_form/changechecker';\nimport * as pageSelectors from 'local_custompage/local/selectors';\nimport $ from 'jquery';\nimport Notification from 'core/notification';\n\n\nlet pageId = 0;\nlet contextId = 0;\n\nexport const init = (id, contextid) => {\n\n    pageId = id;\n    contextId = contextid;\n\n  // Lets get the form and add into proper container\n    editDetailsCard(pageId, contextId);\n};\n\n\nconst editDetailsCard = (pageid, contextid) => {\n    const pendingPromise = new Pending('local_custompage/details:edit');\n\n    // Load audience form with data for editing, then toggle visible controls in the card.\n    const detailsForm = initDetailsCardForm();\n    detailsForm.load({'id': pageid, 'needactionbuttons': 1})\n        .then(() => {\n            return pendingPromise.resolve();\n        })\n        .catch(Notification.exception);\n};\n\nconst initDetailsCardForm = () => {\n    const detailsFormContainer = document.querySelector(pageSelectors.regions.detailsFormContainer);\n    const detailsForm = new DynamicForm(detailsFormContainer, '\\\\local_custompage\\\\form\\\\page');\n\n    // After submitting the form, update the card instance and description properties.\n    detailsForm.addEventListener(detailsForm.events.FORM_SUBMITTED, data => {\n\n        return getString('details-saved', 'local_custompage')\n            .then(addToast).then(() => {\n              return window.location.reload();\n            });\n    });\n\n    return detailsForm;\n};\n\n"],"names":["pageId","contextId","id","contextid","editDetailsCard","pageid","pendingPromise","Pending","initDetailsCardForm","load","then","resolve","catch","Notification","exception","detailsFormContainer","document","querySelector","pageSelectors","regions","detailsForm","DynamicForm","addEventListener","events","FORM_SUBMITTED","data","addToast","window","location","reload"],"mappings":"kyDAcIA,OAAS,EACTC,UAAY,gBAEI,CAACC,GAAIC,aAErBH,OAASE,GACTD,UAAYE,UAGZC,gBAAgBJ,OAAQC,kBAItBG,gBAAkB,CAACC,OAAQF,mBACvBG,eAAiB,IAAIC,iBAAQ,iCAGfC,sBACRC,KAAK,IAAOJ,yBAA6B,IAChDK,MAAK,IACKJ,eAAeK,YAEzBC,MAAMC,sBAAaC,YAGtBN,oBAAsB,WAClBO,qBAAuBC,SAASC,cAAcC,cAAcC,QAAQJ,sBACpEK,YAAc,IAAIC,qBAAYN,qBAAsB,yCAG1DK,YAAYE,iBAAiBF,YAAYG,OAAOC,gBAAgBC,OAErD,mBAAU,gBAAiB,oBAC7Bf,KAAKgB,YAAUhB,MAAK,IACZiB,OAAOC,SAASC,aAI1BT"}